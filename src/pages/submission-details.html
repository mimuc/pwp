<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../shared-styles.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-label/iron-label.html">
<link rel="import" href="../../bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="../sumasy-icons.html">

<dom-module id="submission-details">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
                padding: 10px;
            }

            table {
                width: 100%;
            }

            paper-material {
                padding: 5px;
                width: 60px;
                margin: 5px;
            }

            .abstract {
                margin-top: 15px;
                display: block;
            }

            .single {
                display: inline-block;
                width: auto;
            }

            .multiple {
                display: inline-block;
            }

            div > paper-card {
                width: 100%;
                --paper-card-header-text: {
                    font-size: 40px;
                };
                margin-bottom: 20px;
            }

            .reviews {
                width: auto;
                display: compact;
                --paper-card-header-text: {
                    font-weight: 500;
                    font-size: 25px;
                };
            }

            paper-button > iron-icon {
                padding-right: 8px;
            }

            .href {
                text-decoration: none;
            }
        </style>
        <div class="card">
            <h2>Submission Details</h2>
            <paper-card heading="[[submission.title]]">
                <div class="card-content">

                    <paper-material class="single" elevation="1">
                        <b>Status:</b>
                        <iron-label> [[paperStatus.1.text]]
                            <iron-icon style="color:[[paperStatus.1.color]]"
                                       icon="sumasy-icons:[[paperStatus.1.icon]]"></iron-icon>
                        </iron-label>
                    </paper-material>

                </div>
                <div class="actions">
                    <template is="dom-repeat" items="{{ possibleActions }}">
                        <a href="[[item.link]]" class="href">
                            <paper-button>
                                <iron-icon icon="sumasy-icons:[[item.icon]]"></iron-icon>
                                [[item.text]]
                            </paper-button>
                        </a>
                    </template>
                </div>
            </paper-card>
            <paper-card>
                <div class="card-content">
                    <div class="multiple">
                        <b>Authors: </b>
                        <template is="dom-repeat" items="{{ submission.authors }}">
                            <a href="" style="text-decoration: none">
                                <paper-material class="single" elevation="1">[[item]]</paper-material>
                            </a>
                        </template>
                    </div><br>
                    <div class="multiple"><b>Tags: </b>
                        <template is="dom-repeat" items="{{ submission.tags }}">
                            <a href="" style="text-decoration: none">
                                <paper-material class="single" elevation="1">[[item.name]]</paper-material>
                            </a>
                        </template>
                    </div>
                    <div class="abstract">
                        <b>Abstract: </b><br>
                        [[submission.abstract]]
                    </div>
                </div>
                <div class="card-actions">
                    <br>
                    <p><b>Reviews</b></p>
                    <template class="reviews" is="dom-repeat" items="{{ submission.reviews }}">
                        <paper-card class="reviews href" heading="Review [[index]]">
                            <div class="card-content">
                                <table>
                                    <tr>
                                        <td><b>Score:</b></td>
                                        <td>[[item.reviewer.reviewerScore]]</td>
                                    </tr>
                                    <tr>
                                        <td><b>Annotations:</b></td>
                                        <td>[[item.annotations]]</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="card-actions">
                                <a href="#/review-details" style="text-decoration: none">
                                    <paper-button>
                                        <iron-icon icon="sumasy-icons:pageview"></iron-icon>
                                        View Review
                                    </paper-button>

                                </a>
                            </div>
                        </paper-card>
                    </template>

                </div>
            </paper-card>
            <!--
            <table>
                <tr>
                    <td></td>
                    <td>Review</td>
                    <td>Score</td>
                    <td>Annotations</td>
                </tr>
                <tr>
                    <td></td>
                    <td><a href="#/review-details">Reviewer 1</a></td>
                    <td>3 (Borderline)</td>
                    <td>10</td>
                </tr>

                <tr>
                    <td></td>
                    <td>Reviewer 3</td>
                    <td>5 (Strong Accept)</td>
                    <td>1</td>
                </tr>
            </table>
            -->
            <p>
                <a href="#/submission-overview">Back to Submission Overview</a>
            </p>
        </div>
    </template>

    <script>
      class SubmissionDetails extends Polymer.Element {
        static get is() {
          return 'submission-details';
        }

        static get properties() {
          return {
            submission: {
              type: Object,
              value: function () {
                return {
                  title: 'Great Paper for CHI next year',
                  paperLink: 'https://www.downloadPaper.com',
                  authors: ['Bastian Schweinsteiger', 'Jens Lehmann'],
                  abstract: 'Lorem ipsum dolor sit amet, consetetur sadipscing elitr, ' +
                  'sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat,' +
                  ' sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum.' +
                  ' Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. ' +
                  'Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod ' +
                  'tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. ' +
                  'At vero eos et accusam et justo duo dolores et ea rebum. ' +
                  'Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.',
                  status: 'accepted',
                  tags: [{name: 'password security', link: 'tag/1'}, {name: 'usability security', link: 'tag/2'}],
                  reviews: [{
                    reviewer: {
                      name: 'Konrad Bartolotti',
                      reviewerScore: '3 (Borderline)'
                    },
                    annotations: 10,
                    reviewLink: 'https://www.downloadReview1.com'
                  }, {
                    reviewer: {
                      name: 'Antonio Banderas',
                      reviewerScore: '2 (reject)'
                    },
                    annotations: 5,
                    reviewLink: 'https://www.downloadReview2.com'
                  }, {
                    reviewer: {
                      name: 'Max Mustermann',
                      reviewerScore: '5 (strong accept)'
                    },
                    annotations: 1,
                    reviewLink: 'https://www.downloadReview3.com'
                  }]
                }
              },
              reflectToAttribute: true,
              observer: '_submissionChanged'
            },
            possibleActions: {
              type: Array,
              value: function () {
                return [
                  {icon: 'file-download', text: 'Download Paper', link: ''},
                  {icon: 'edit', text: 'Edit Submission', link: '#/submission-overview'}
                ]
              }
            }, paperStatus: {
              type: Array,
              value: function () {
                return [
                  {icon: 'check-circle', text: 'Accepted', color: 'green'},
                  {icon: 'close', text: 'Declined', color: 'red'},
                  {icon: 'schedule', text: 'In Progress', color: 'gray'}
                ]
              }
            }
          };
        }

        _submissionChanged(submission) {
          // TODO
        }
      }
      window.customElements.define((SubmissionDetails).is, SubmissionDetails);
    </script>
</dom-module>
